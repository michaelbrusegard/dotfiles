"use strict";var $=Object.create;var E=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var X=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty;var q=(e,n)=>{for(var o in n)E(e,o,{get:n[o],enumerable:!0})},A=(e,n,o,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of X(n))!_.call(e,a)&&a!==o&&E(e,a,{get:()=>n[a],enumerable:!(c=M(n,a))||c.enumerable});return e};var y=(e,n,o)=>(o=e!=null?$(j(e)):{},A(n||!e||!e.__esModule?E(o,"default",{value:e,enumerable:!0}):o,e)),H=e=>A(E({},"__esModule",{value:!0}),e);var ne={};q(ne,{default:()=>J,useLocalExtensions:()=>W});module.exports=H(ne);var s=require("@raycast/api"),p=require("react");var Q=require("@raycast/api"),w=y(require("fs"));var h=y(require("fs/promises")),R=y(require("os")),u=y(require("path")),D=y(require("child_process")),P=require("@raycast/api");function K(e){if(!e)return e;let n=e.match(/%(.+)%/);if(n)return n[1]}var O={Code:"/Applications/Visual Studio Code.app/Contents/Resources/app/bin/code","Code - Insiders":"/Applications/Visual Studio Code - Insiders.app/Contents/Resources/app/bin/code",Cursor:"/Applications/Cursor.app/Contents/Resources/app/bin/cursor",VSCodium:"/Applications/VSCodium.app/Contents/Resources/app/bin/codium"};function z(){let e=O[B()];return!e||e.length<=0?O.Code:e}var F=class{constructor(n){this.cliFilename=n}installExtensionByIDSync(n){D.execFileSync(this.cliFilename,["--install-extension",n,"--force"])}uninstallExtensionByIDSync(n){D.execFileSync(this.cliFilename,["--uninstall-extension",n,"--force"])}};function N(){return new F(z())}async function G(e){try{if(await S(e)){let n=await h.readFile(e,{encoding:"utf-8"}),o=JSON.parse(n),c=o.displayName,a=K(c),i=o.icon,l=u.default.dirname(e);if(a&&a.length>0){let d=u.default.join(l,"package.nls.json");try{if(await S(d)){let x=await h.readFile(d,{encoding:"utf-8"}),k=JSON.parse(x)[a];k&&k.length>0&&(c=k)}}catch{}}let m=o.preview,f=i?u.default.join(l,i):void 0;return{displayName:c,icon:f,preview:m}}}catch{}}async function v(){let e=u.default.join(R.homedir(),`.${I()}/extensions`),n=u.default.join(e,"extensions.json");if(await S(n)){let o=await h.readFile(n,{encoding:"utf-8"}),c=JSON.parse(o);if(c&&c.length>0){let a=[];for(let i of c){let l=typeof i.location=="string"?u.default.join(e,i.location):i.location.fsPath??i.location.path,m=u.default.join(l,"package.json"),f=await G(m);a.push({id:i.identifier.id,name:f?.displayName||i.identifier.id,version:i.version,preRelease:i.metadata?.preRelease,icon:f?.icon,updated:i.metadata?.updated,fsPath:l,publisherId:i.metadata.publisherId,publisherDisplayName:i.metadata.publisherDisplayName,preview:f?.preview,installedTimestamp:i.metadata?.installedTimestamp})}return a}}}function B(){return(0,P.getPreferenceValues)().build}var L={Code:"vscode","Code - Insiders":"vscode-insiders",Cursor:"cursor",VSCodium:"vscode-oss"};function I(){let e=L[B()];return!e||e.length<=0?L.Code:e}function C(e){return e instanceof Error?e.message:"unknown error"}async function S(e){return w.promises.access(e,w.constants.F_OK).then(()=>!0).catch(()=>!1)}var re=new Intl.NumberFormat("en",{notation:"compact"});var t=require("@raycast/api");var b=require("react/jsx-runtime");function T(e){return(0,b.jsx)(t.Action,{onAction:async()=>{try{await(0,t.confirmAlert)({title:"Uninstall Extension?",icon:{source:t.Icon.Trash,tintColor:t.Color.Red},primaryAction:{style:t.Alert.ActionStyle.Destructive,title:"Uninstall"}})&&(await(0,t.showToast)({style:t.Toast.Style.Animated,title:"Install Extension"}),N().uninstallExtensionByIDSync(e.extensionID),await(0,t.showToast)({style:t.Toast.Style.Success,title:"Uninstall Successful"}),e.afterUninstall&&e.afterUninstall())}catch(o){(0,t.showToast)({style:t.Toast.Style.Failure,title:"Error",message:C(o)})}},title:"Uninstall Extension",icon:{source:t.Icon.Trash,tintColor:t.Color.Red}})}function U(e){return(0,b.jsx)(t.Action.OpenInBrowser,{title:"Open in VSCode",url:`${I()}:extension/${e.extensionID}`,icon:"icon.png",onOpen:n=>{(0,t.showHUD)("Open VSCode Extension"),e.onOpen&&e.onOpen(n)}})}function V(e){let n=`https://marketplace.visualstudio.com/items?itemName=${e.extensionID}`;return(0,b.jsx)(t.Action.OpenInBrowser,{title:"Open in Browser",url:n,shortcut:{modifiers:["cmd"],key:"b"},onOpen:()=>{(0,t.showHUD)("Open VSCode Extension in Browser")}})}var r=require("react/jsx-runtime");function Y(e){return(0,r.jsx)(U,{extensionID:e.extension.id})}function Z(e){return(0,r.jsx)(V,{extensionID:e.extension.id})}function ee(e){let n=e.extension;return(0,r.jsx)(s.List.Item,{title:n.name,subtitle:n.publisherDisplayName,icon:{source:n.icon||"icon.png",fallback:"icon.png"},accessories:[{tag:n.preview===!0?{color:s.Color.Red,value:"Preview"}:""},{tag:n.version,tooltip:n.installedTimestamp?`Installed:  ${new Date(n.installedTimestamp).toLocaleString()}`:""}],actions:(0,r.jsxs)(s.ActionPanel,{children:[(0,r.jsxs)(s.ActionPanel.Section,{children:[(0,r.jsx)(Y,{extension:n}),(0,r.jsx)(Z,{extension:n})]}),(0,r.jsxs)(s.ActionPanel.Section,{children:[(0,r.jsx)(s.Action.CopyToClipboard,{content:n.id,title:"Copy Extension ID",shortcut:{modifiers:["cmd","shift"],key:"."}}),(0,r.jsx)(s.Action.CopyToClipboard,{content:n.publisherDisplayName,title:"Copy Publisher Name",shortcut:{modifiers:["cmd","shift"],key:","}}),(0,r.jsx)(s.Action.Open,{title:"Open in Finder",target:n.fsPath,shortcut:{modifiers:["cmd","shift"],key:"f"}})]}),(0,r.jsx)(s.ActionPanel.Section,{children:(0,r.jsx)(T,{extensionID:n.id,afterUninstall:e.reloadExtension})})]})})}function J(){let{extensions:e,isLoading:n,error:o,refresh:c}=W();o&&(0,s.showToast)({style:s.Toast.Style.Failure,title:"Error",message:o});let a=e?.sort((i,l)=>i.name<l.name?-1:i.name>l.name?1:0);return(0,r.jsx)(s.List,{isLoading:n,searchBarPlaceholder:"Search Installed Extensions",children:(0,r.jsx)(s.List.Section,{title:"Installed Extensions",subtitle:`${a?.length}`,children:a?.map(i=>(0,r.jsx)(ee,{extension:i,reloadExtension:c},i.id))})})}function W(){let[e,n]=(0,p.useState)(!0),[o,c]=(0,p.useState)(),[a,i]=(0,p.useState)(),[l,m]=(0,p.useState)(new Date),f=()=>{m(new Date)};return(0,p.useEffect)(()=>{let d=!1;async function x(){if(!d){n(!0),i(void 0);try{let g=await v();d||c(g)}catch(g){d||i(C(g))}finally{d||n(!1)}}}return x(),()=>{d=!0}},[l]),{extensions:o,isLoading:e,error:a,refresh:f}}0&&(module.exports={useLocalExtensions});
